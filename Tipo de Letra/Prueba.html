<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Series - Letra P</title>
  
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: url(https://static.wixstatic.com/media/8a7da0_da693a5c2b2d42bbb084707197421b0a~mv2.png);
      padding: 20px;
      margin: 0;
    }

    .filtros {
      background: rgba(255, 255, 255, 0.8);
      padding: 20px 30px;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      gap: 30px;
      transition: all 0.3s ease;
    }

    .selector-servicio {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-width: 200px;
      padding-right: 20px;
      border-right: 1px solid #e0e0e0;
    }

    .botones-servicio {
      display: flex;
      gap: 8px;
      margin-bottom: 5px;
      flex-wrap: wrap;
    }

    .selector-servicio button {
      padding: 10px 14px;
      border-radius: 10px;
      border: none;
      background: #014c8c;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .selector-servicio button:hover {
      background: #0360b2;
      transform: translateY(-2px);
    }

    .selector-servicio button.activo {
      background: #5c94ff;
      box-shadow: 0 0 8px rgba(92, 148, 255, 0.6);
    }

    /* Estilos espec√≠ficos para cada servicio */
    .btn-firebase.activo {
      background: #4285f4;
      box-shadow: 0 0 8px rgba(66, 133, 244, 0.6);
    }

    .btn-cloudflare.activo {
      background: #f6821f;
      box-shadow: 0 0 8px rgba(246, 130, 31, 0.6);
    }

    .btn-sheets.activo {
      background: #0f9d58;
      box-shadow: 0 0 8px rgba(15, 157, 88, 0.6);
    }

    .estado-servicio {
      font-weight: bold;
      color: #014c8c;
      font-size: 14px;
      text-align: left;
      width: 100%;
      padding: 5px 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .estado-servicio::before {
      content: "üü¢";
      font-size: 10px;
    }

    .contenedor-filtros {
      display: flex;
      align-items: center;
      gap: 15px;
      flex: 1;
    }

    .filtros input[type="text"],
    .filtros select {
      padding: 10px 16px;
      border-radius: 15px;
      border: 1px solid #b0d6ff;
      background-color: #f8fbff;
      font-size: 16px;
      color: #014c8c;
      box-shadow: 0 2px 6px rgba(0, 76, 140, 0.1);
      transition: box-shadow 0.3s ease, border 0.3s ease;
      outline: none;
      width: 280px;
    }

    .filtros input[type="text"]:focus,
    .filtros select:focus {
      border-color: #5c94ff;
      box-shadow: 0 0 8px rgba(92, 148, 255, 0.4);
    }

    input[type="text"], select {
      padding: 8px;
      width: 280px;
      margin: 5px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    .contenedor-cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0;
      margin-top: 40px;
    }

    .carta-wrapper {
      width: 500px;
      margin: 0 20px 40px 20px;
      display: flex;
      flex-direction: column;
    }

    .carta-superpuesta {
      transform: translate(30px, 20px);
      z-index: 2;
    }

    .card {
      width: 100%;
      display: grid;
      grid-template-columns: 160px auto;
      align-items: start;
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
      overflow: hidden;
      position: relative;
    }

    .card:hover {
      transform: scale(1.02);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }

    .card-imagen {
      width: 160px;
      height: 250px;
      overflow: hidden;
      border-top-left-radius: 15px;
      border-bottom-left-radius: 15px;
      flex-shrink: 0;
    }

    .card-imagen img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: top;
    }

    .card-contenido {
      padding: 15px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      background-color: rgba(255, 255, 255, 0.95);
      border-top-right-radius: 15px;
      border-bottom-right-radius: 15px;
      height: auto;
      overflow-wrap: break-word;
      word-wrap: break-word;
      word-break: break-word;
    }

    .nombre-id {
      font-size: 18px;
      font-weight: bold;
      color: #002d80;
      white-space: normal;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    .titulo {
      font-weight: bold;
      font-size: 16px;
      color: #014c8c;
      white-space: normal;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    .subtitulo {
      color: #555;
      font-size: 14px;
      margin-bottom: 6px;
      white-space: normal;
      overflow-wrap: break-word;
      word-break: break-word;
    }

    .etiquetas span {
      display: inline-block;
      background: #008cff;
      color: white;
      padding: 5px 10px;
      border-radius: 15px;
      margin: 3px 5px 0 0;
      font-size: 12px;
    }

    .boton-ver {
      background: #5c94ff;
      color: white;
      border: none;
      padding: 8px 16px;
      margin-top: 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .boton-ver:hover {
      background: #3a7cff;
    }

    .navegacion-contenedor {
      background: rgba(255, 255, 255, 0.8);
      padding: 20px 30px;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin: 40px auto 20px auto;
      max-width: 600px;
      display: flex;
      justify-content: center;
    }

    .navegacion {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    .navegacion button {
      padding: 10px 24px;
      font-size: 15px;
      background: #014c8c;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      box-shadow: 0 2px 6px rgba(0, 76, 140, 0.2);
    }

    .navegacion button:hover {
      background: #0360b2;
      transform: scale(1.03);
    }

    #infoPagina {
      font-weight: bold;
      font-size: 16px;
      color: #002d80;
    }

    /* Estilos para mensajes de carga y error */
    .mensaje-carga {
      text-align: center;
      padding: 40px;
      font-size: 18px;
      color: #014c8c;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      margin: 20px auto;
      max-width: 600px;
    }

    .mensaje-error {
      text-align: center;
      padding: 20px;
      background: #ffebee;
      color: #c62828;
      border-radius: 10px;
      margin: 20px auto;
      max-width: 600px;
      border: 1px solid #ffcdd2;
    }

    @media (max-width: 768px) {
      .filtros {
        flex-direction: column;
        gap: 15px;
      }
      
      .selector-servicio {
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
        padding-right: 0;
        padding-bottom: 15px;
        width: 100%;
      }
      
      .contenedor-filtros {
        flex-direction: column;
        width: 100%;
      }
      
      .filtros input[type="text"],
      .filtros select {
        width: 100%;
      }
      
      .carta-wrapper {
        width: 100%;
        margin: 0 10px 30px 10px;
      }
      
      .carta-superpuesta {
        transform: none;
      }
    }
  </style>
</head>
<body>
  <div class="filtros">
    <!-- Selector de servicio en el costado izquierdo -->
    <div class="selector-servicio">
      <div class="botones-servicio">
        <button id="btnFirebase" class="activo btn-firebase" onclick="cambiarServicio('firebase')">Firebase</button>
        <button id="btnCloudflare" class="btn-cloudflare" onclick="cambiarServicio('cloudflare')">Cloudflare</button>
        <button id="btnSheets" class="btn-sheets" onclick="cambiarServicio('sheets')">Google Sheets</button>
      </div>
      <div class="estado-servicio" id="estadoServicio">Servicio: Firebase</div>
    </div>
    
    <!-- Filtros originales en l√≠nea -->
    <div class="contenedor-filtros">
      <input type="text" id="buscador" placeholder="Buscar serie por nombre...">
      <select id="nombreSelector"></select>
    </div>
  </div>

  <div id="cargaContainer" class="mensaje-carga" style="display: none;">
    <div>‚è≥ Cargando series desde <span id="servicioCarga"></span>...</div>
  </div>

  <div id="errorContainer" class="mensaje-error" style="display: none;"></div>

  <div class="contenedor-cards" id="cardsContainer"></div>

  <div class="navegacion-contenedor">
    <div class="navegacion">
      <button onclick="paginaAnterior()">&#8592; Anterior</button>
      <span id="infoPagina"></span>
      <button onclick="paginaSiguiente()">Siguiente &#8594;</button>
    </div>
  </div>

  <script>
    // Configuraci√≥n de servicios
    const firebaseConfig = {
      apiKey: "AIzaSyB6MY2y5uyum87PdUHUpY8NNh4D73Yhx4U",
      authDomain: "animes-plus-89b93.firebaseapp.com",
      projectId: "animes-plus-89b93",
      storageBucket: "animes-plus-89b93.appspot.com",
      messagingSenderId: "402867181985",
      appId: "1:402867181985:web:d695b12977fe4270dbd3e0",
      measurementId: "G-DN632G7XJT"
    };
    
    // Configuraci√≥n de Cloudflare
    const cloudflareConfig = {
      baseURL: 'https://proyecto-cloudflare.apiprueba2025.workers.dev',
      endpoints: {
        indiceSeries: '/indice-series',
        buscarIndice: '/buscar-indice'
      }
    };
    
    // Configuraci√≥n de Google Sheets
    const googleSheetsConfig = {
      SPREADSHEET_ID: '1V4LTYiuTDZ_Y_k6GRyVmFm5-G3rVhE6x1KfIcxJfLqM',
      SHEET_NAME: 'Indices',
      RANGE: 'A:H' // Ajusta seg√∫n las columnas de tu hoja
    };

    // Variables globales
    let servicioActual = 'firebase';
    let firebaseInicializado = false;
    let db;
    let series = [];
    let todas = [];
    let pagina = 0;
    const porPagina = 10;
    const letraActual = 'p'; // ‚Üê Letra fija

    // Inicializar Firebase
    function inicializarFirebase() {
      if (!firebaseInicializado) {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        firebaseInicializado = true;
      }
    }

    // Cambiar entre servicios
    function cambiarServicio(servicio) {
      servicioActual = servicio;
      
      // Actualizar botones
      document.getElementById('btnFirebase').classList.toggle('activo', servicio === 'firebase');
      document.getElementById('btnCloudflare').classList.toggle('activo', servicio === 'cloudflare');
      document.getElementById('btnSheets').classList.toggle('activo', servicio === 'sheets');
      
      // Actualizar estado
      let servicioTexto = '';
      if (servicio === 'firebase') servicioTexto = 'Firebase';
      else if (servicio === 'cloudflare') servicioTexto = 'Cloudflare';
      else servicioTexto = 'Google Sheets';
      
      document.getElementById('estadoServicio').textContent = `Servicio: ${servicioTexto}`;
      
      // Recargar datos
      cargarSeries();
    }

    // Mostrar mensaje de carga
    function mostrarCarga(mensaje) {
      document.getElementById('cargaContainer').style.display = 'block';
      document.getElementById('errorContainer').style.display = 'none';
      document.getElementById('cardsContainer').innerHTML = '';
      document.getElementById('servicioCarga').textContent = mensaje;
    }

    // Ocultar mensaje de carga
    function ocultarCarga() {
      document.getElementById('cargaContainer').style.display = 'none';
    }

    // Mostrar error
    function mostrarError(mensaje) {
      document.getElementById('errorContainer').style.display = 'block';
      document.getElementById('errorContainer').innerHTML = mensaje;
      document.getElementById('cargaContainer').style.display = 'none';
      document.getElementById('cardsContainer').innerHTML = '';
    }

    // Ocultar error
    function ocultarError() {
      document.getElementById('errorContainer').style.display = 'none';
    }

    // Funci√≥n para obtener datos de Cloudflare
    async function obtenerDeCloudflare(endpoint, params = {}) {
      try {
        let url = cloudflareConfig.baseURL + endpoint;
        
        if (Object.keys(params).length > 0) {
          const queryParams = new URLSearchParams(params);
          url += '?' + queryParams.toString();
        }
        
        const response = await fetch(url);
        
        if (!response.ok) {
          throw new Error(`Error HTTP: ${response.status}`);
        }
        
        return await response.json();
      } catch (error) {
        console.error('Error al obtener datos de Cloudflare:', error);
        throw error;
      }
    }

    // Funci√≥n para obtener datos de Google Sheets
    async function obtenerDeGoogleSheets() {
      try {
        // URL para obtener los datos en formato CSV
        const csvUrl = `https://docs.google.com/spreadsheets/d/${googleSheetsConfig.SPREADSHEET_ID}/gviz/tq?tqx=out:csv&sheet=${googleSheetsConfig.SHEET_NAME}`;
        
        console.log("Cargando desde Google Sheets URL:", csvUrl);
        const response = await fetch(csvUrl);
        
        if (!response.ok) {
          throw new Error(`Error HTTP: ${response.status}`);
        }
        
        const csvText = await response.text();
        console.log("Datos CSV recibidos:", csvText.substring(0, 500));
        
        // Parsear el CSV
        const rows = parseGoogleSheetsCSV(csvText);
        
        if (rows.length === 0) {
          throw new Error("No se encontraron datos en Google Sheets");
        }
        
        // Identificar √≠ndices de columnas basados en encabezados
        const headers = rows[0].map(h => h.trim().toLowerCase());
        console.log("Encabezados encontrados:", headers);
        
        const indexId = headers.findIndex(h => h.includes('id') || h.includes('nombre') || h.includes('serie'));
        const indexNombreSec = headers.findIndex(h => h.includes('nombresec') || h.includes('t√≠tulo'));
        const indexNombreSec02 = headers.findIndex(h => h.includes('nombresec02') || h.includes('subt√≠tulo'));
        const indexAnio = headers.findIndex(h => h.includes('a√±o') || h.includes('anio') || h.includes('year'));
        const indexCategoria = headers.findIndex(h => h.includes('categoria') || h.includes('categor√≠a') || h.includes('g√©nero'));
        const indexIdioma = headers.findIndex(h => h.includes('idioma') || h.includes('language'));
        const indexImagen = headers.findIndex(h => h.includes('imagen') || h.includes('image') || h.includes('portada'));
        const indexSitio = headers.findIndex(h => h.includes('sitio') || h.includes('link') || h.includes('url'));
        
        // Validar columnas esenciales
        if (indexId === -1 || indexNombreSec === -1 || indexImagen === -1 || indexSitio === -1) {
          console.error("Encabezados necesarios no encontrados:", {
            id: indexId, nombresec: indexNombreSec, imagen: indexImagen, sitio: indexSitio
          });
          throw new Error("Formato de Google Sheets incorrecto. Se necesitan columnas: ID/Nombre, NombreSec, Imagen, Sitio");
        }
        
        const datos = [];
        
        // Procesar filas
        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];
          
          if (row.length <= Math.max(indexId, indexNombreSec, indexImagen, indexSitio)) {
            continue;
          }
          
          const id = (row[indexId] || '').trim();
          const nombresec = (row[indexNombreSec] || '').trim();
          const nombresec02 = indexNombreSec02 !== -1 ? (row[indexNombreSec02] || '').trim() : '';
          const a√±o = indexAnio !== -1 ? (row[indexAnio] || '').trim() : '';
          const categoria = indexCategoria !== -1 ? (row[indexCategoria] || '').trim() : 'Sin categor√≠a';
          const idioma = indexIdioma !== -1 ? (row[indexIdioma] || '').trim() : 'Espa√±ol';
          const imagen = (row[indexImagen] || '').trim();
          const sitio = (row[indexSitio] || '').trim();
          
          if (!id || !nombresec || !imagen || !sitio) {
            continue;
          }
          
          datos.push({
            id: id,
            nombresec: nombresec,
            nombresec02: nombresec02,
            a√±o: a√±o,
            categoria: categoria,
            idioma: idioma,
            imagen: imagen,
            sitio: sitio
          });
        }
        
        return datos;
        
      } catch (error) {
        console.error("Error cargando desde Google Sheets:", error);
        throw error;
      }
    }

    // Funci√≥n auxiliar para parsear CSV de Google Sheets
    function parseGoogleSheetsCSV(text) {
      const rows = [];
      const lines = text.split('\n');
      
      for (const line of lines) {
        if (!line.trim()) continue;
        
        const row = [];
        let currentCell = '';
        let insideQuotes = false;
        
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          
          if (char === '"') {
            insideQuotes = !insideQuotes;
          } else if (char === ',' && !insideQuotes) {
            row.push(currentCell.trim());
            currentCell = '';
          } else {
            currentCell += char;
          }
        }
        
        row.push(currentCell.trim());
        
        const cleanedRow = row.map(cell => {
          return cell.replace(/^"|"$/g, '');
        });
        
        rows.push(cleanedRow);
      }
      
      return rows;
    }

    // Cargar series desde el servicio activo
    async function cargarSeries() {
      try {
        ocultarError();
        
        let servicioTexto = '';
        if (servicioActual === 'firebase') servicioTexto = 'Firebase';
        else if (servicioActual === 'cloudflare') servicioTexto = 'Cloudflare';
        else servicioTexto = 'Google Sheets';
        
        mostrarCarga(servicioTexto);
        
        if (servicioActual === 'firebase') {
          await cargarDesdeFirebase();
        } else if (servicioActual === 'cloudflare') {
          await cargarDesdeCloudflare();
        } else {
          await cargarDesdeGoogleSheets();
        }
        
        ocultarCarga();
      } catch (error) {
        console.error(`Error al cargar desde ${servicioActual}:`, error);
        ocultarCarga();
        
        // Determinar servicio alternativo
        let servicioAlternativo = '';
        if (servicioActual === 'firebase') {
          servicioAlternativo = 'cloudflare';
        } else if (servicioActual === 'cloudflare') {
          servicioAlternativo = 'sheets';
        } else {
          servicioAlternativo = 'firebase';
        }
        
        mostrarError(`
          <strong>Error al cargar desde ${servicioActual}</strong><br>
          ${error.message}<br><br>
          <button onclick="cambiarServicio('${servicioAlternativo}')" 
                  style="padding: 8px 16px; background: #014c8c; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Intentar con ${servicioAlternativo === 'firebase' ? 'Firebase' : servicioAlternativo === 'cloudflare' ? 'Cloudflare' : 'Google Sheets'}
          </button>
        `);
      }
    }

    // Cargar desde Firebase
    async function cargarDesdeFirebase() {
      inicializarFirebase();
      const snapshot = await db.collection("animes-series-indice").get();
      todas = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

      // Filtra por la letra espec√≠fica
      series = todas.filter(serie => serie.id.toLowerCase().startsWith(letraActual));
      pagina = 0;
      actualizarSelector();
      mostrarPagina();
    }

    // Cargar desde Cloudflare
    async function cargarDesdeCloudflare() {
      const datos = await obtenerDeCloudflare(cloudflareConfig.endpoints.indiceSeries);
      
      // Mapear datos de Cloudflare al formato esperado
      todas = datos.map(item => ({
        id: item.nombreSerie,
        nombresec: item.nombresec,
        nombresec02: item.nombresec02,
        a√±o: item.a√±o,
        categoria: item.categoria,
        idioma: item.idioma,
        imagen: item.imagen,
        sitio: item.sitio
      }));

      // Filtra por la letra espec√≠fica
      series = todas.filter(serie => serie.id.toLowerCase().startsWith(letraActual));
      pagina = 0;
      actualizarSelector();
      mostrarPagina();
    }

    // Cargar desde Google Sheets
    async function cargarDesdeGoogleSheets() {
      const datos = await obtenerDeGoogleSheets();
      
      // Mapear datos de Google Sheets al formato esperado
      todas = datos.map(item => ({
        id: item.id,
        nombresec: item.nombresec,
        nombresec02: item.nombresec02,
        a√±o: item.a√±o,
        categoria: item.categoria,
        idioma: item.idioma,
        imagen: item.imagen,
        sitio: item.sitio
      }));

      // Filtra por la letra espec√≠fica
      series = todas.filter(serie => serie.id.toLowerCase().startsWith(letraActual));
      pagina = 0;
      actualizarSelector();
      mostrarPagina();
      
      console.log(`Cargadas ${series.length} series desde Google Sheets (letra ${letraActual.toUpperCase()})`);
    }

    // Actualizar selector de nombres
    function actualizarSelector() {
      const nombreSelector = document.getElementById("nombreSelector");

      let opciones = `<option value="">Todas las series con la letra "${letraActual.toUpperCase()}" (${series.length})</option>`;
      opciones += series.map(s => `<option value="${s.id}">${s.id}</option>`).join('');
      nombreSelector.innerHTML = opciones;
      nombreSelector.selectedIndex = 0;
    }

    // Manejar cambio en el selector de nombres
    document.getElementById("nombreSelector").addEventListener("change", e => {
      const seleccion = e.target.value;
      pagina = 0;

      if (seleccion === "") {
        mostrarPagina();
        return;
      }

      const contenedor = document.getElementById("cardsContainer");
      contenedor.innerHTML = "";

      const filtradas = series.filter(s => s.id === seleccion);

      filtradas.forEach((s, i) => {
        const wrapper = document.createElement("div");
        wrapper.className = "carta-wrapper";
        if (i % 2 === 1) wrapper.classList.add("carta-superpuesta");

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="card-imagen">
            <img src="${s.imagen}" alt="${s.nombresec}" onerror="this.src='https://via.placeholder.com/160x250?text=Sin+Imagen'"/>
          </div>
          <div class="card-contenido">
            <div class="nombre-id">${s.id}</div>
            <div class="titulo">${s.nombresec}</div>
            <div class="subtitulo">${s.nombresec02 || ""}</div>
            <div class="subtitulo">${s.a√±o} - ${s.idioma}</div>
            <div class="etiquetas">
              ${s.categoria.split(',').map(c => `<span>${c.trim()}</span>`).join('')}
            </div>
            <button class="boton-ver" onclick="window.open('${s.sitio}', '_blank')">Ver Ahora</button>
          </div>
        `;
        wrapper.appendChild(card);
        contenedor.appendChild(wrapper);
      });
    });

    // Mostrar p√°gina actual
    function mostrarPagina() {
      const contenedor = document.getElementById("cardsContainer");
      contenedor.innerHTML = "";
      const inicio = pagina * porPagina;
      const fin = inicio + porPagina;
      const filtradas = series.slice(inicio, fin);

      filtradas.forEach((s, i) => {
        const wrapper = document.createElement("div");
        wrapper.className = "carta-wrapper";
        if (i % 2 === 1) wrapper.classList.add("carta-superpuesta");

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="card-imagen">
            <img src="${s.imagen}" alt="${s.nombresec}" onerror="this.src='https://via.placeholder.com/160x250?text=Sin+Imagen'"/>
          </div>
          <div class="card-contenido">
            <div class="nombre-id">${s.id}</div>
            <div class="titulo">${s.nombresec}</div>
            <div class="subtitulo">${s.nombresec02 || ""}</div>
            <div class="subtitulo">${s.a√±o} - ${s.idioma}</div>
            <div class="etiquetas">
              ${s.categoria.split(',').map(c => `<span>${c.trim()}</span>`).join('')}
            </div>
            <button class="boton-ver" onclick="window.open('${s.sitio}', '_blank')">Ver Ahora</button>
          </div>
        `;
        wrapper.appendChild(card);
        contenedor.appendChild(wrapper);
      });

      actualizarInfoPagina();
    }

    // Actualizar informaci√≥n de p√°gina
    function actualizarInfoPagina() {
      const totalPaginas = Math.ceil(series.length / porPagina);
      document.getElementById("infoPagina").textContent = `P√°gina ${pagina + 1} de ${totalPaginas}`;
    }

    // Navegaci√≥n de p√°ginas
    function paginaSiguiente() {
      if ((pagina + 1) * porPagina < series.length) {
        pagina++;
        mostrarPagina();
      }
    }

    function paginaAnterior() {
      if (pagina > 0) {
        pagina--;
        mostrarPagina();
      }
    }

    // B√∫squeda en tiempo real
    document.getElementById("buscador").addEventListener("input", e => {
      const texto = e.target.value.toLowerCase();
      pagina = 0;
      const contenedor = document.getElementById("cardsContainer");
      contenedor.innerHTML = "";

      const resultados = series.filter(s => s.id.toLowerCase().includes(texto));
      resultados.slice(0, porPagina).forEach((s, i) => {
        const wrapper = document.createElement("div");
        wrapper.className = "carta-wrapper";
        if (i % 2 === 1) wrapper.classList.add("carta-superpuesta");

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="card-imagen">
            <img src="${s.imagen}" alt="${s.nombresec}" onerror="this.src='https://via.placeholder.com/160x250?text=Sin+Imagen'"/>
          </div>
          <div class="card-contenido">
            <div class="nombre-id">${s.id}</div>
            <div class="titulo">${s.nombresec}</div>
            <div class="subtitulo">${s.nombresec02 || ""}</div>
            <div class="subtitulo">${s.a√±o} - ${s.idioma}</div>
            <div class="etiquetas">
              ${s.categoria.split(',').map(c => `<span>${c.trim()}</span>`).join('')}
            </div>
            <button class="boton-ver" onclick="window.open('${s.sitio}', '_blank')">Ver Ahora</button>
          </div>
        `;
        wrapper.appendChild(card);
        contenedor.appendChild(wrapper);
      });
    });

    // Inicializar la aplicaci√≥n
    document.addEventListener('DOMContentLoaded', function() {
      cargarSeries();
    });
  </script>
</body>
</html>